<!DOCTYPE html>
<html>
<head>
  <title>面接評価</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>面接評価結果</h1>
  <canvas id="barChart"></canvas>

  <script>
    // 感情推定の値が入力される配列
    const emotionArray = [8, 7, 6, 5, 8, 9, 7, 8, 6, 5];

    // その他の要素を仮に設定（実際のデータはここに入れる）
    const answerArray = [9, 7, 5, 3, 8, 6, 7, 9, 5, 7];
    const nonVerbalArray = [8, 5, 4, 3, 7, 6, 5, 8, 3, 6];

    // 総合スコアを計算する関数
    function calculateTotalScore(emotionArray, answerArray, nonVerbalArray) {
      const numDataPoints = emotionArray.length;

      // 各要素の重みを設定
      const emotionWeight = 0.4;
      const answerWeight = 0.3;
      const nonVerbalWeight = 0.2;

      // 総合スコアを初期化
      let totalScore = 0;

      // 各要素のスコアを合計
      for (let i = 0; i < numDataPoints; i++) {
        const emotionScore = emotionArray[i] * emotionWeight;
        const answerScore = answerArray[i] * answerWeight;
        const nonVerbalScore = nonVerbalArray[i] * nonVerbalWeight;

        // 各要素のスコアを加算
        totalScore += (emotionScore + answerScore + nonVerbalScore);
      }

      return totalScore;
    }

    // ページ読み込み時に棒グラフを描画
    document.addEventListener('DOMContentLoaded', function() {
      const barChart = new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
          labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
          datasets: [{
            label: '総合スコア',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            data: Array(emotionArray.length).fill(0), // 初期値は0
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

      // 1秒ごとに総合スコアを更新
      setInterval(function() {
        const totalScore = calculateTotalScore(emotionArray, answerArray, nonVerbalArray);
        barChart.data.datasets[0].data = [totalScore]; // データを更新
        barChart.update(); // グラフを更新
      }, 1000);
    });
  </script>
</body>
</html>
